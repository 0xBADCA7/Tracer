
Installing TracerGrind
----------------------
# Installation notes tested on Debian Jessie
# First install some essential packages before starting
sudo apt-get install build-essential automake libcapstone-dev
# You probably also want to have MongoDB for the traces
sudo apt-get install mongodb mongodb-clients

Usage with Wine:
----------------
Run another exe in wine first to keep wineserver up & running
wine notepad.exe &
Then e.g.:
valgrind --quiet --trace-children=yes --tool=tracergrind --filter=0x400000-0x401000 --vex-iropt-register-updates=allregs-at-mem-access --output=foo.trace wine some_interesting.exe

Usage with Android:
-------------------
cf valgrind-3.10.1/README.android
see compilation notes above till before ./configure, then:

export NDKROOT=/path/to/your/android-ndk-r9c
export AR=$NDKROOT/toolchains/arm-linux-androideabi-4.8/prebuilt/linux-x86_64/bin/arm-linux-androideabi-ar
export LD=$NDKROOT/toolchains/arm-linux-androideabi-4.8/prebuilt/linux-x86_64/bin/arm-linux-androideabi-ld
export CC=$NDKROOT/toolchains/arm-linux-androideabi-4.8/prebuilt/linux-x86_64/bin/arm-linux-androideabi-gcc

CPPFLAGS="--sysroot=$NDKROOT/platforms/android-3/arch-arm" \
   CFLAGS="--sysroot=$NDKROOT/platforms/android-3/arch-arm" \
   ./configure --prefix=/data/local/Inst \
   --host=armv7-unknown-linux --target=armv7-unknown-linux \
   --with-tmpdir=/sdcard
make
mkdir ../build
make install DESTDIR=$(pwd)/../build
=> That makes a ../build/data/local/Inst

adb push ../build /

=> installed in /data/local/Inst/

/data/local/Inst/bin/valgrind --kernel-variant=android-gpu-adreno3xx --trace-children=yes --tool=tracergrind --filter=0x400000-0x401000 --vex-iropt-register-updates=allregs-at-mem-access --output=/sdcard/foo.trace mybin

If Android 5.x
=> https://bugs.kde.org/show_bug.cgi?id=331178
workaround: --sigill-diagnostics=no

/data/local/Inst/bin/valgrind --kernel-variant=android-gpu-adreno3xx --sigill-diagnostics=no --trace-children=yes --tool=tracergrind --filter=0x400000-0x401000 --vex-iropt-register-updates=allregs-at-mem-access --output=/sdcard/foo.trace mybin

